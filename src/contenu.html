REMARQUE
Lorsque la commission est égal à 0 il n'affiche pas mais prend le
décompte de ligne de règlement d'assureur en compte



# Récupérer le dernier historique de la police
dernier_historique = HistoriquePolice.objects.filter(police_id=police_old.id).order_by('-date_du_jour').first()

# Récupérer les assureurs associés à l'historique
assureur_police = PoliceAssureur.objects.filter(compagnie_id=compagnie_id, type_compagnie_id=1).first()

polices = Police.objects.filter(id=assureur_police.historique_police.police_id)

site_logo_url = request.build_absolute_uri(static(settings.JAZZMIN_SETTINGS['site_logo']))
print("Logo : ", site_logo_url)

'site_logo_url': site_logo_url,


TRUNCATE `aliment_police`; TRUNCATE `apporteurs_police`; TRUNCATE `autre_risque`; TRUNCATE `client_police`; TRUNCATE `historique_apporteurs_police`; TRUNCATE `historique_ordonnancement_sinistre`; TRUNCATE `autre_risque`;
TRUNCATE `historique_paiement_comptable_sinistre`; TRUNCATE `historique_polices`; TRUNCATE `historique_taxe_police`; TRUNCATE `mouvements_aliments`; TRUNCATE `mouvements_polices`;
TRUNCATE `mouvement_quittance`; TRUNCATE `police_assureurs`; TRUNCATE `police_garantie`; TRUNCATE `vehicules`; TRUNCATE `vehicule_police`; TRUNCATE `polices`; TRUNCATE `periode_couverture`;
TRUNCATE `quittances`; TRUNCATE `reglements`; TRUNCATE `reglement_compagnie`; TRUNCATE `reglement_facture_compagnie`; TRUNCATE `reglement_facture_compagnie`; TRUNCATE `acomptes`; TRUNCATE `encaissement_commission`;
TRUNCATE `journal`; TRUNCATE `operations`; TRUNCATE `operation_reglement`; TRUNCATE `historique_aliment`; TRUNCATE `clients`; TRUNCATE `produit`;



//Changement de branche, charger les produits liés
$('#branche').on('change', function () {

    let branche_id = $(this).val();
    $('#produit').html('<option value="">---------------------------</option>');

    $.ajax({
        type: 'get',
        url: '/production/branche/' + branche_id + '/produits',
        success: function (produits) {

            $('#produit').html('').append('<option value="">Sélectionnez un produit</option>');

            produits.forEach(function (produit) {
                $('#produit').append('<option value="' + produit.pk + '">' + produit.fields.libelle + '</option>');
            });

        },
        error: function () { }
    });
});